<idea-plugin allow-bundled-update="true">
    <id>openjml</id>
    <name>OpenJML</name>
    <category>Languages</category>
    <description><![CDATA[
  ]]>
    </description>
    <depends>com.intellij.modules.java</depends>
    <depends>com.intellij.modules.xml</depends>
    <depends>org.intellij.intelliLang</depends>
    <resource-bundle>messages.OpenJMLBundle</resource-bundle>
    <vendor>Pawel Kierat</vendor>

    <idea-version since-build="243" until-build="251.*"/>

    <extensions defaultExtensionNs="com.intellij">
        <fileType
                name="JML"
                implementationClass="dev.kierat.plugins.openjml.psi.JMLFileType"
                fieldName="INSTANCE"
                language="JML"
                extensions="jml"/>

        <lang.parserDefinition language="JML"
                               implementationClass="dev.kierat.plugins.openjml.psi.JMLParserDefinition"/>

        <contentFolderType id="jml"
                           name="JML Specification Root"
                           isTestSource="false"
                           icon="/org/openjml/icons/openjml.png"
                           moduleSourceRootType="org.jetbrains.jps.model.java.JavaSourceRootType"/>

        <applicationConfigurable
                id="openjml.settings"
                displayName="OpenJML"
                instance="dev.kierat.plugins.openjml.settings.OpenJMLSettingsConfigurable"/>

        <lang.formatter
                language="JML"
                implementationClass="dev.kierat.plugins.openjml.formatting.JMLFormattingModelBuilder"/>
        <defaultHighlightingSettingProvider
                implementationClass="dev.kierat.plugins.openjml.highlighting.JMLHighlightingSettingProvider"/>

        <gotoRelatedProvider implementation="dev.kierat.plugins.openjml.navigation.GotoJmlRelatedProvider"/>
        <codeInsight.lineMarkerProvider
                language="JAVA"
                implementationClass="dev.kierat.plugins.openjml.navigation.JMLLineMarkerProvider"/>
        <codeInsight.inlayProvider
                language="JAVA"
                implementationClass="dev.kierat.plugins.openjml.hints.JMLInlayHintsProvider"/>

        <annotator language="JAVA" implementationClass="dev.kierat.plugins.openjml.annotator.JMLAnnotator"/>
        <annotator language="JML" implementationClass="dev.kierat.plugins.openjml.annotator.JMLAnnotator"/>

        <applicationService serviceImplementation="dev.kierat.plugins.openjml.settings.OpenJMLSettings"/>

        <intentionAction>
            <language>JAVA</language>
            <className>dev.kierat.plugins.openjml.intention.AddFieldSpecificationIntention</className>
            <categoryKey>intention.family.name.openjml</categoryKey>
        </intentionAction>
        <intentionAction>
            <language>JAVA</language>
            <className>dev.kierat.plugins.openjml.intention.AddMethodSpecificationIntention</className>
            <categoryKey>intention.family.name.openjml</categoryKey>
        </intentionAction>
        <intentionAction>
            <language>JAVA</language>
            <className>dev.kierat.plugins.openjml.intention.AddClassSpecificationIntention</className>
            <categoryKey>intention.family.name.openjml</categoryKey>
        </intentionAction>
    </extensions>

    <actions>
        <action id="GoToJMLSpecificationAction"
                class="dev.kierat.plugins.openjml.action.GoToJMLSpecificationAction"
                text="Go to Specification"
                description="Open the JML specification for this Java file">
            <add-to-group group-id="ProjectViewPopupMenu" anchor="after" relative-to-action="RunClass"/>
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt 0"/>
        </action>
        <action id="RunOpenJMLAction"
                class="dev.kierat.plugins.openjml.action.RunOpenJMLEscAction"
                text="Verify with OpenJML"
                description="Run OpenJML ESC on selected Java class or package"
                icon="AllIcons.Actions.Execute">
            <add-to-group group-id="ProjectViewPopupMenu" anchor="after"
                          relative-to-action="GoToJMLSpecificationAction"/>
            <add-to-group group-id="EditorPopupMenu" anchor="after" relative-to-action="RunClass"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl shift 0"/>
        </action>
    </actions>

    <extensionPoints>
        <extensionPoint
                qualifiedName="dev.kierat.plugins.openjml.openjmlExtensionPoint"
                interface="dev.kierat.plugins.openjml.OpenJMLExtensionPoint"
                dynamic="true"/>
    </extensionPoints>
</idea-plugin>
