<idea-plugin allow-bundled-update="true">
    <id>openjml</id>
    <name>OpenJML</name>
    <category>Languages</category>
    <description><![CDATA[
  ]]>
    </description>
    <depends>com.intellij.modules.xml</depends>
    <!--  <depends>com.intellij.modules.spellchecker</depends>-->
    <depends>org.intellij.intelliLang</depends>
    <!--  <depends>com.intellij.modules.regexp</depends>-->
    <resource-bundle>messages.OpenJMLBundle</resource-bundle>
    <vendor>Pawel Kierat</vendor>

    <idea-version since-build="243" until-build="251.*"/>

    <extensions defaultExtensionNs="com.intellij">
        <fileType
                name="JML"
                implementationClass="dev.kierat.plugins.openjml.psi.JMLFileType"
                fieldName="INSTANCE"
                language="JML"
                extensions="jml"/>

        <lang.parserDefinition language="JML"
                               implementationClass="dev.kierat.plugins.openjml.psi.JMLParserDefinition"/>

        <contentFolderType id="jml"
                           name="JML Specification Root"
                           isTestSource="false"
                           icon="/org/openjml/icons/openjml.png"
                           moduleSourceRootType="org.jetbrains.jps.model.java.JavaSourceRootType"/>

        <applicationConfigurable
                id="openjml.settings"
                displayName="OpenJML"
                instance="dev.kierat.plugins.openjml.settings.OpenJMLSettingsConfigurable"/>

        <gotoRelatedProvider implementation="dev.kierat.plugins.openjml.navigation.GotoJmlRelatedProvider"/>

        <annotator language="JAVA" implementationClass="dev.kierat.plugins.openjml.annotator.JMLAnnotator"/>
        <annotator language="JML" implementationClass="dev.kierat.plugins.openjml.annotator.JMLAnnotator"/>

        <highlightVisitor language="JML"
                          implementationClass="dev.kierat.plugins.openjml.inspection.JMLHighlightVisitor"/>

        <applicationService serviceImplementation="dev.kierat.plugins.openjml.settings.OpenJMLSettings"/>
    </extensions>

    <actions>
        <action id="GoToJMLSpecificationAction"
                class="dev.kierat.plugins.openjml.action.GoToJMLSpecificationAction"
                text="Go to Specification"
                description="Open the JML specification for this Java file">
            <add-to-group group-id="ProjectViewPopupMenu" anchor="after" relative-to-action="RunClass" />
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt 0"/>
        </action>
        <action id="RunOpenJMLAction"
                class="dev.kierat.plugins.openjml.action.RunOpenJMLEscAction"
                text="Verify with OpenJML"
                description="Run OpenJML ESC on selected Java class or package"
                icon="AllIcons.Actions.Execute">
            <add-to-group group-id="ProjectViewPopupMenu" anchor="after" relative-to-action="GoToJMLSpecificationAction" />
            <add-to-group group-id="EditorPopupMenu" anchor="after" relative-to-action="RunClass" />
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl shift 0"/>
        </action>
    </actions>

    <extensionPoints>
        <extensionPoint
                qualifiedName="dev.kierat.plugins.openjml.openjmlExtensionPoint"
                interface="dev.kierat.plugins.openjml.OpenJMLExtensionPoint"
                dynamic="true"/>
    </extensionPoints>
</idea-plugin>
